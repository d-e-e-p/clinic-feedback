<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="page_title">Clinic Feedback</title>
    <link rel="stylesheet" href="/css/page_style.css">
</head>
<body>
    <video id="sm-video" autoplay playsinline></video>
    <div id="status" data-i18n="initializing">Initializing...</div>
    
    <progress id="connection-progress" value="0" max="5"></progress>
    
    <div id="timer-display">
        <div id="progress-bar-container">
            <div id="progress-bar"></div>
        </div>
    </div>
    <div id="timer-position">
        <div id="timer-text">3:00</div>
    </div>
    <div id="controls">
        <button id="disconnect-button" data-i18n="disconnect_button">End Session</button>
    </div>
    <div id="thank-you-screen">
        <h2 data-i18n="thank_you_title">Thank You for Your Feedback!</h2>
        <p data-i18n="session_ended_redirect">This session has ended. Redirecting...</p>
    </div>
    
    <script src="/js/config.js"></script>
    <script src="/js/translations.js"></script>
    <script src="/js/smwebsdk.min.js"></script>
    <script>
      // Extract language from URL parameter
      
      // Apply translations
      function applyTranslations(langCode) {
        const t = translations[langCode] || translations.en;
        
        // Update HTML lang attribute
        
        // Update all elements with data-i18n
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.getAttribute('data-i18n');
          if (t[key]) {
            el.textContent = t[key];
          }
        });
        
        // Store for use in app.js
        sessionStorage.setItem('selectedLang', langCode);
        window.currentTranslations = t;
      }

      const urlParams = new URLSearchParams(window.location.search);
      const lang = urlParams.get('lang') || 'en';
      document.documentElement.lang = lang;
      console.log("=== feedback.html ===");
      console.log('URL Search:', window.location.search);
      console.log('All params:', Object.fromEntries(urlParams));
      console.log(`Language: ${lang}`);

      document.addEventListener('DOMContentLoaded', () => {
        applyTranslations(lang);
    });
      
    </script>
    <script src="/js/app.js"></script>
</body>
</html>
